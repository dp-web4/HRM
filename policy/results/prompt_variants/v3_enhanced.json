{
  "total_scenarios": 8,
  "passed": 8,
  "failed": 0,
  "pass_rate": 1.0,
  "by_difficulty": {
    "easy": {
      "total": 2,
      "passed": 2
    },
    "medium": {
      "total": 2,
      "passed": 2
    },
    "hard": {
      "total": 2,
      "passed": 2
    },
    "edge_case": {
      "total": 2,
      "passed": 2
    }
  },
  "average_scores": {
    "decision_correct": 1.0,
    "reasoning_coverage_semantic": 0.9166666666666666,
    "reasoning_coverage_keyword": 0.4583333333333333,
    "output_structure": 1.0
  },
  "detailed_results": [
    {
      "scenario_id": "E01",
      "difficulty": "easy",
      "scores": {
        "decision_correct": true,
        "reasoning_coverage_semantic": 1.0,
        "reasoning_coverage_keyword": 0.3333333333333333,
        "output_structure": 1.0
      },
      "passed": true,
      "reasoning_details": [
        {
          "expected": "read action",
          "best_match": "Role Check: Member role is permitted to perform read actions \u2713\n2",
          "similarity": 0.549762487411499,
          "match_type": "semantic",
          "present": true
        },
        {
          "expected": "public resource",
          "best_match": "Environment: Accessing public documentation is considered a standard, low-risk action, with no special requirements or risks identified for the resource in question \u2713\n4",
          "similarity": 0.6132416725158691,
          "match_type": "semantic",
          "present": true
        },
        {
          "expected": "sufficient trust",
          "best_match": "integrity \u2713\n3",
          "similarity": 0.4921002686023712,
          "match_type": "semantic",
          "present": true
        }
      ],
      "response": "Classification: Routine Read Access\nRisk Level: Low\nDecision: Allow\n\nReasoning:\n1. Role Check: Member role is permitted to perform read actions \u2713\n2. Trust Check: T3 scores (0.7, 0.8, 0.9) are well above the typical threshold for routine activities and show high competence, reliability, and integrity \u2713\n3. Environment: Accessing public documentation is considered a standard, low-risk action, with no special requirements or risks identified for the resource in question \u2713\n4. Context: This is a standard team activity with default policies, and there are no unusual patterns or identity metrics to consider. Alice's action type and resource are typical for a member of the team, and there is no indication of deviation from established patterns or identity level concerns.\n\nPolicy References:\n- Routine read actions are permitted for all roles\n- Access to public documentation is unrestricted and considered low-risk.",
      "variant": "v3_enhanced"
    },
    {
      "scenario_id": "E02",
      "difficulty": "easy",
      "scores": {
        "decision_correct": true,
        "reasoning_coverage_semantic": 1.0,
        "reasoning_coverage_keyword": 0.0,
        "output_structure": 1.0
      },
      "passed": true,
      "reasoning_details": [
        {
          "expected": "admin only",
          "best_match": "Required role: admin\n2",
          "similarity": 0.527788519859314,
          "match_type": "semantic",
          "present": true
        },
        {
          "expected": "insufficient role",
          "best_match": "Required role: admin\n2",
          "similarity": 0.708776593208313,
          "match_type": "semantic",
          "present": true
        },
        {
          "expected": "high-risk action",
          "best_match": "Environment: Production team with strict policies implies a high-risk environment where actions are tightly controlled",
          "similarity": 0.6122666597366333,
          "match_type": "semantic",
          "present": true
        }
      ],
      "response": "Classification: Unauthorized Action\nRisk Level: High\nDecision: Deny\n\nReasoning:\n1. Role Check: Developer role cannot perform delete_team action. Required role: admin\n2. Trust Check: T3 scores are high (0.8, 0.9, 0.95), indicating strong trustworthiness.\n3. Environment: Production team with strict policies implies a high-risk environment where actions are tightly controlled.\n4. Context: The action requested by the developer is not only outside the typical permissions of their role but also in an environment where strict policies are enforced, which further justifies denial.\n\nPolicy References:\n- Admin actions require explicit role permissions (e.g., admin role)\n- Strict policies in production environments typically mean that only certain roles with additional privileges can perform sensitive actions like deleting a team.",
      "variant": "v3_enhanced"
    },
    {
      "scenario_id": "M01",
      "difficulty": "medium",
      "scores": {
        "decision_correct": true,
        "reasoning_coverage_semantic": 1.0,
        "reasoning_coverage_keyword": 0.0,
        "output_structure": 1.0
      },
      "passed": true,
      "reasoning_details": [
        {
          "expected": "borderline trust",
          "best_match": "Classification: borderline_deploy_trust\nRisk Level: Medium\nDecision: require_attestation\n\nReasoning:\n1",
          "similarity": 0.531731367111206,
          "match_type": "semantic",
          "present": true
        },
        {
          "expected": "high-risk environment",
          "best_match": "Environment: Production environment is high-risk",
          "similarity": 0.7846460938453674,
          "match_type": "semantic",
          "present": true
        },
        {
          "expected": "attestation recommended",
          "best_match": "Classification: borderline_deploy_trust\nRisk Level: Medium\nDecision: require_attestation\n\nReasoning:\n1",
          "similarity": 0.47561293840408325,
          "match_type": "semantic",
          "present": true
        }
      ],
      "response": "Classification: borderline_deploy_trust\nRisk Level: Medium\nDecision: require_attestation\n\nReasoning:\n1. Role Check: Deployer role can perform deploy actions \u2713\n2. Trust Check: T3 scores (0.72, 0.68, 0.75) meet or exceed the 0.7 threshold required for deploy actions, which aligns with the team policy. Competence and integrity are above the threshold, but reliability is marginally below at 0.68.\n3. Environment: Production environment is high-risk, necessitating a higher degree of certainty for actions that can significantly impact the system.\n4. Context: Charlie has a recent history of 5 successful deploys in the past month, which indicates an established pattern of competent performance. However, the reliability score being below 0.7 introduces uncertainty about the potential for a successful deployment.\n\nPolicy References:\n- Team policy requires 0.7 trust for deploy actions in production.\n- Production environment requires additional verification for actions that can impact system stability and security.",
      "variant": "v3_enhanced"
    },
    {
      "scenario_id": "M02",
      "difficulty": "medium",
      "scores": {
        "decision_correct": true,
        "reasoning_coverage_semantic": 0.6666666666666666,
        "reasoning_coverage_keyword": 1.0,
        "output_structure": 1.0
      },
      "passed": true,
      "reasoning_details": [
        {
          "expected": "unusual timing",
          "best_match": "Environment: Core repository, standard risk, but the unusual timing introduces a new factor to consider\n4",
          "similarity": 1.0,
          "match_type": "exact_phrase",
          "present": true
        },
        {
          "expected": "pattern deviation",
          "best_match": "Policy References:\n- Pattern deviations require additional verification\n- Unusual timing from actors with consistent patterns should be confirmed to ensure the action's legitimacy",
          "similarity": 0.3277890682220459,
          "match_type": "no_match",
          "present": false
        },
        {
          "expected": "additional verification",
          "best_match": "Policy References:\n- Pattern deviations require additional verification\n- Unusual timing from actors with consistent patterns should be confirmed to ensure the action's legitimacy",
          "similarity": 1.0,
          "match_type": "exact_phrase",
          "present": true
        }
      ],
      "response": "Classification: unusual_timing_commit\nRisk Level: Medium\nDecision: require_attestation\n\nReasoning:\n1. Role Check: Developer role can perform commit actions \u2713\n2. Trust Check: T3 scores (0.9, 0.85, 0.9) are excellent, indicating high competence, reliability, and integrity \u2713\n3. Environment: Core repository, standard risk, but the unusual timing introduces a new factor to consider\n4. Context: **Unusual timing** (3:30 AM) deviates from the **established pattern** of team members typically working 9-5 EST. Diana's recent history shows she **never commits outside business hours**, which suggests an unexpected behavior that needs **additional verification** to ensure that the commit was intentional and not due to an error or compromise.\n\nPolicy References:\n- Pattern deviations require additional verification\n- Unusual timing from actors with consistent patterns should be confirmed to ensure the action's legitimacy.",
      "variant": "v3_enhanced"
    },
    {
      "scenario_id": "H01",
      "difficulty": "hard",
      "scores": {
        "decision_correct": true,
        "reasoning_coverage_semantic": 1.0,
        "reasoning_coverage_keyword": 0.3333333333333333,
        "output_structure": 1.0
      },
      "passed": true,
      "reasoning_details": [
        {
          "expected": "production impact",
          "best_match": "the fact that it triggers an auto-deploy to production elevates the risk level significantly",
          "similarity": 0.44119691848754883,
          "match_type": "semantic",
          "present": true
        },
        {
          "expected": "auto-deploy",
          "best_match": "Environment: Production with auto-deploy makes this effectively a deploy action, which is high-risk\n4",
          "similarity": 1.0,
          "match_type": "exact_phrase",
          "present": true
        },
        {
          "expected": "config vs code distinction",
          "best_match": "Context: Even though the action is a config change",
          "similarity": 0.41553232073783875,
          "match_type": "semantic",
          "present": true
        }
      ],
      "response": "Classification: config_change_with_deploy_impact\nRisk Level: High\nDecision: require_attestation\n\nReasoning:\n1. Role Check: Developer role can update configs \u2713\n2. Trust Check: T3 scores (0.8, 0.85, 0.9) are strong \u2713\n3. Environment: Production with auto-deploy makes this effectively a deploy action, which is high-risk\n4. Context: Even though the action is a config change, the fact that it triggers an auto-deploy to production elevates the risk level significantly. It is akin to a deploy action and requires careful consideration. There is no pattern deviation, established pattern, or identity level concern here.\n\nPolicy References:\n- Actions that trigger production deploys require deploy-level approval\n- Auto-deploy configs should be treated as deploy actions\n- High risk necessitates attestation regardless of trust level.",
      "variant": "v3_enhanced"
    },
    {
      "scenario_id": "H02",
      "difficulty": "hard",
      "scores": {
        "decision_correct": true,
        "reasoning_coverage_semantic": 0.6666666666666666,
        "reasoning_coverage_keyword": 0.0,
        "output_structure": 1.0
      },
      "passed": true,
      "reasoning_details": [
        {
          "expected": "high baseline trust",
          "best_match": "Classification: high_trust_declining_performance\nRisk Level: High\nDecision: require_attestation\n\nReasoning:\n1",
          "similarity": 0.5430399775505066,
          "match_type": "semantic",
          "present": true
        },
        {
          "expected": "recent pattern change",
          "best_match": "Context: Frank's recent history of 3 failed deploys in the past week represents a pattern deviation from his usual performance",
          "similarity": 0.3499600291252136,
          "match_type": "no_match",
          "present": false
        },
        {
          "expected": "investigate before allowing",
          "best_match": "suggests a need for investigation",
          "similarity": 0.5611120462417603,
          "match_type": "semantic",
          "present": true
        }
      ],
      "response": "Classification: high_trust_declining_performance\nRisk Level: High\nDecision: require_attestation\n\nReasoning:\n1. Role Check: Admin role can perform deploy actions \u2713\n2. Trust Check: T3 scores (0.95, 0.92, 0.98) are excellent, but the recent trend shows a decline in performance with coherence at 0.65, which is a significant drop and suggests a need for investigation. The declining pattern deviates from the established pattern of high competence and reliability.\n3. Environment: Production is a high-risk environment where actions can have significant impacts on the system and its users. The trust in an admin performing such actions is paramount.\n4. Context: Frank's recent history of 3 failed deploys in the past week represents a pattern deviation from his usual performance. The declining identity metrics with coherence at 0.65 further indicate that his current reliability and integrity may not be as strong as his historical performance.\n\nPolicy References:\n- Declining performance patterns warrant investigation even with high trust.\n- Identity coherence below 0.7 triggers additional scrutiny.\n- High-risk environments like production necessitate a higher threshold for trust in actions that can cause widespread disruption.",
      "variant": "v3_enhanced"
    },
    {
      "scenario_id": "EC01",
      "difficulty": "edge_case",
      "scores": {
        "decision_correct": true,
        "reasoning_coverage_semantic": 1.0,
        "reasoning_coverage_keyword": 1.0,
        "output_structure": 1.0
      },
      "passed": true,
      "reasoning_details": [
        {
          "expected": "exemplary identity",
          "best_match": "Context: This is an automated deploy triggered by a merged PR, which fits within the established pattern of successful automated deployments by the bot, with an exemplary identity level and high coherence (0",
          "similarity": 1.0,
          "match_type": "exact_phrase",
          "present": true
        },
        {
          "expected": "automation",
          "best_match": "98) indicating a stable and trustworthy automated operation\n\nPolicy References:\n- Exemplary identity level with established patterns can auto-approve\n- Bot accounts with consistent performance are trusted for automation",
          "similarity": 1.0,
          "match_type": "exact_phrase",
          "present": true
        },
        {
          "expected": "established pattern",
          "best_match": "Context: This is an automated deploy triggered by a merged PR, which fits within the established pattern of successful automated deployments by the bot, with an exemplary identity level and high coherence (0",
          "similarity": 1.0,
          "match_type": "exact_phrase",
          "present": true
        }
      ],
      "response": "Classification: automated_deploy\nRisk Level: Low\nDecision: Allow\n\nReasoning:\n1. Role Check: ci_bot role can perform automated deploys \u2713\n2. Trust Check: T3 scores (0.99, 0.99, 1.0) are excellent, well above any reasonable threshold \u2713\n3. Environment: Staging is a lower risk environment compared to production\n4. Context: This is an automated deploy triggered by a merged PR, which fits within the established pattern of successful automated deployments by the bot, with an exemplary identity level and high coherence (0.98) indicating a stable and trustworthy automated operation\n\nPolicy References:\n- Exemplary identity level with established patterns can auto-approve\n- Bot accounts with consistent performance are trusted for automation",
      "variant": "v3_enhanced"
    },
    {
      "scenario_id": "EC02",
      "difficulty": "edge_case",
      "scores": {
        "decision_correct": true,
        "reasoning_coverage_semantic": 1.0,
        "reasoning_coverage_keyword": 1.0,
        "output_structure": 1.0
      },
      "passed": true,
      "reasoning_details": [
        {
          "expected": "emergency context",
          "best_match": "Context: Emergency context (SEV1 incident) may warrant exception, but insufficient solo trust - Grace's trust is borderline and this is an admin-level action",
          "similarity": 1.0,
          "match_type": "exact_phrase",
          "present": true
        },
        {
          "expected": "insufficient solo trust",
          "best_match": "Context: Emergency context (SEV1 incident) may warrant exception, but insufficient solo trust - Grace's trust is borderline and this is an admin-level action",
          "similarity": 1.0,
          "match_type": "exact_phrase",
          "present": true
        },
        {
          "expected": "need oversight",
          "best_match": "Need oversight despite urgency, should escalate to available admin or require secondary approval\n\nPolicy References:\n- Emergency exceptions still require appropriate oversight\n- Critical actions need sufficient trust or multi-party approval",
          "similarity": 1.0,
          "match_type": "exact_phrase",
          "present": true
        }
      ],
      "response": "Classification: emergency_action_borderline_trust\nRisk Level: High\nDecision: require_attestation\n\nReasoning:\n1. Role Check: Developer role typically cannot perform database_rollback (admin action) \u2717\n2. Trust Check: T3 scores (0.75, 0.7, 0.8) are borderline for high-risk actions ~\n3. Environment: Production database is a critical resource\n4. Context: Emergency context (SEV1 incident) may warrant exception, but insufficient solo trust - Grace's trust is borderline and this is an admin-level action. Need oversight despite urgency, should escalate to available admin or require secondary approval\n\nPolicy References:\n- Emergency exceptions still require appropriate oversight\n- Critical actions need sufficient trust or multi-party approval",
      "variant": "v3_enhanced"
    }
  ],
  "variant": "v3_enhanced",
  "timestamp": "2026-02-03T20:14:26"
}